<div class="form">
	<mat-card>
		<mat-card-header>
			<mat-card-title>Data Call Details</mat-card-title>
		</mat-card-header>
		<mat-divider></mat-divider>
		<mat-card-content class="data-form">
			<form
				class="pb-2"
				[formGroup]="registerForm"
				(submit)="updateFields(tempDate, tempURL, tempPattern)"
			>
				<div class="row">
					<div class="col">
						<mat-form-field appearance="outline" class="full-width">
							<mat-label>Delivery Date</mat-label>
							<input
								matInput
								[matDatepicker]="deadlinePicker"
								formControlName="proposedDeliveryDate"
							/>
							<mat-datepicker-toggle
								matSuffix
								[for]="deadlinePicker"
							></mat-datepicker-toggle>
							<mat-datepicker #deadlinePicker></mat-datepicker>
						</mat-form-field>
					</div>
					<div class="col">
						<mat-form-field appearance="outline" class="full-width">
							<mat-label>Extraction Pattern</mat-label>
							<mat-select
								placeholder="Select Extraction Pattern"
								formControlName="extractionPatternID"
							>
								<mat-option
									[value]="data.extractionPatternID"
									*ngFor="let data of extractionPatternList"
									>{{
										data.extractionPatternName
									}}</mat-option
								>
							</mat-select>
						</mat-form-field>
					</div>
					<div class="col flex2">
						<mat-form-field class="full-width" appearance="outline">
							<mat-label>Forum URL</mat-label>
							<input
								matInput
								type="url"
								placeholder="Enter Forum URL"
								formControlName="forumUrl"
							/>
						</mat-form-field>
					</div>
				</div>
				<div class="row pb-2">
					<div class="col"></div>
					<div class="col right">
						<button
							mat-button
							color="primary"
							(click)="showPattern()"
						>
							View & Download Patterns
						</button>
					</div>
					<div class="col flex2 right">
						<button mat-flat-button color="primary">
							Update Details
						</button>
					</div>
				</div>
				<mat-divider></mat-divider>
			</form>
			<div class="row">
				<div class="col readonly">
					<h4>Name</h4>
					<p>
						{{ draft.name }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Jurisdiction</h4>
					<p>
						{{ draft.jurisdiction }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Description</h4>
					<p>
						{{ draft.description }}
					</p>
				</div>
			</div>
			<div class="row">
				<div class="col readonly">
					<h4>Line of Business</h4>
					<p>
						{{ draft.lineOfBusiness }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Premium Dates</h4>
					<p>
						{{ draft.premiumFromDate }} to
						{{ draft.premiumToDate }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Loss Dates</h4>
					<p>
						{{ draft.lossFromDate }} to
						{{ draft.lossToDate }}
					</p>
				</div>
			</div>
			<div class="row">
				<div class="col readonly">
					<h4>Expected Public Circulation?</h4>
					<p>
						{{ draft.intentToPublish ? 'Yes' : 'No' }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Add list of participants to summary report</h4>
					<p>
						{{ draft.isShowParticipants ? 'Yes' : 'No' }}
					</p>
				</div>
				<div class="col readonly">
					<h4>Proposed Delivery Date</h4>
					<p>
						<mat-form-field
							appearance="fill"
							*ngIf="isStatAgent && isUpdate"
						>
							<mat-label>Select Delivery Date</mat-label>
							<input matInput [matDatepicker]="dp3" disabled />
							<mat-datepicker-toggle
								matSuffix
								[for]="dp3"
							></mat-datepicker-toggle>
							<mat-datepicker
								#dp3
								disabled="false"
							></mat-datepicker>
						</mat-form-field>
						<span *ngIf="isUpdate">{{
							draft.proposedDeliveryDate | date: 'MM/dd/yyyy '
						}}</span>
					</p>
				</div>
			</div>

			<div class="row">
				<div class="col button-row">
					<button mat-stroked-button color="primary">
						<mat-icon color="primary">check_circle</mat-icon>
						Consent to the Report
					</button>
					<button
						mat-stroked-button
						color="primary"
						*ngIf="isReg"
						(click)="cloneDatacall(draft)"
					>
						<mat-icon color="primary">content_copy</mat-icon>
						Clone Data Call
					</button>
					<button
						mat-stroked-button
						color="primary"
						*ngIf="isReg || isCarr"
						(click)="viewDrafts()"
					>
						<mat-icon>bookmarks</mat-icon>
						View Draft Versions
					</button>
					<button
						mat-flat-button
						color="primary"
						(click)="viewReport()"
						[disabled]="!isReportAvlbl"
						*ngIf="isReg || isCarr"
					>
						<mat-icon>analytics</mat-icon>
						View Reports
					</button>
				</div>
			</div>
		</mat-card-content>
	</mat-card>

	<div class="pt-2">
		<div class="row">
			<div class="col flex2">
				<mat-card class="data-content">
					<mat-card-content>
						<h2>Purpose</h2>
						<p>
							{{ draft.purpose }}
						</p>

						<h2>Detailed Criteria</h2>
						<p>
							{{ draft.detailedCriteria }}
						</p>

						<h2>Eligibility Requirement</h2>
						<p>
							{{ draft.eligibilityRequirement }}
						</p>
					</mat-card-content>
					<mat-divider *ngIf="isStatAgent"></mat-divider>
					<mat-card-actions align="end">
						<button
							mat-stroked-button
							color="primary"
							*ngIf="isStatAgent"
							(click)="viewDrafts()"
						>
							<mat-icon>bookmarks</mat-icon>
							View Draft Versions
						</button>
					</mat-card-actions>
				</mat-card>
			</div>
			<div class="col">
				<mat-card class="mb-2">
					<mat-card-content>
						<h2>Carrier Consents</h2>
						<p>
							<mat-icon
								color="primary"
								aria-label="Number of Carriers"
								[matBadge]="consentCount"
								matBadgeColor="warn"
								>business</mat-icon
							>
						</p>
						<h2>Organization Likes</h2>
						<p>
							<mat-icon
								color="primary"
								aria-label="Number of Carriers"
								[matBadge]="likeCount"
								matBadgeColor="warn"
							>
								favorite
							</mat-icon>
							<button
								class="btn-org"
								mat-button
								color="primary"
								*ngIf="isStatAgent"
								[disabled]="!isLikeCountPositive"
								(click)="viewCarriers('Liked')"
							>
								View Organizations
							</button>
						</p>
						<h2>Consent Status</h2>
						<p></p>
					</mat-card-content>
				</mat-card>

				<mat-card>
					<mat-card-content>
						<h2>History</h2>
						<app-datacall-history></app-datacall-history>
					</mat-card-content>
				</mat-card>
			</div>
		</div>
	</div>
	<app-update-report
		[datacall]="draft"
		[username]="this.loginResult.username"
		(updateReportEvent)="updateReport($event)"
	></app-update-report>
</div>
<app-spinner *ngIf="isSpinner"></app-spinner>
